# Math AI Tutor 项目迁移指南

本指南帮助您将 Math AI Tutor 项目从当前 Manus 账号迁移到新账号。

---

## 📋 迁移前准备

### 需要的文件
- ✅ GitHub 仓库（代码已导出）
- ✅ 数据库导出文件（本指南会生成）
- ✅ 图片文件（本指南会下载）

### 预计时间
- 导出数据：5-10 分钟
- 下载图片：10-30 分钟（取决于图片数量）
- 导入新账号：15-30 分钟

---

## 第一步：导出当前账号的数据

### 1.1 导出数据库

在当前对话中运行：

```bash
cd /home/ubuntu/math-ai-tutor
npx tsx migration/export-database.ts
```

这会生成三个文件：
- `migration/exported-data.json` - 完整的题目数据（JSON 格式）
- `migration/image-urls.txt` - 所有图片的 URL 列表
- `migration/import-problems.sql` - SQL 导入脚本

### 1.2 下载所有图片

运行：

```bash
npx tsx migration/download-images.ts
```

这会：
- 读取 `image-urls.txt` 中的所有图片 URL
- 下载到 `migration/downloaded-images/` 目录
- 生成 `url-filename-mapping.json` 文件名映射表

### 1.3 打包下载

下载以下文件到本地：
- `migration/` 整个目录（包含所有导出的数据和图片）
- GitHub 仓库地址：[您的 GitHub 用户名]/math-ai-tutor

---

## 第二步：在新账号创建项目

### 2.1 从 GitHub 导入项目

在新 Manus 账号的新对话中说：

```
从 GitHub 导入项目：[您的 GitHub 用户名]/math-ai-tutor
```

AI 会自动：
- 克隆 GitHub 仓库
- 配置数据库和环境变量
- 安装依赖并启动项目

### 2.2 等待项目初始化

项目创建后，AI 会提供：
- 项目预览 URL
- 管理界面访问方式
- 数据库连接信息

---

## 第三步：导入数据

### 3.1 导入数据库数据

**方法一：使用 SQL 脚本（推荐）**

1. 在新对话中说："帮我执行 SQL 脚本导入数据"
2. 上传 `migration/import-problems.sql` 文件
3. AI 会执行 SQL 导入所有题目数据

**方法二：使用管理界面**

1. 打开管理界面 → Database
2. 点击"导入"按钮
3. 上传 `migration/import-problems.sql` 文件

### 3.2 上传图片文件

由于图片存储在 S3，需要重新上传：

**选项 A：使用管理员上传功能（推荐）**

1. 登录新项目（确保您是管理员）
2. 点击"上传题目"按钮
3. 对于每道题目：
   - 上传对应的题目图片（从 `downloaded-images/` 目录）
   - 上传对应的答案图片
   - 题目信息会自动从数据库读取

**选项 B：批量上传脚本**

在新对话中说：
```
帮我创建一个批量上传图片的脚本，将 migration/downloaded-images/ 目录中的图片上传到 S3，并更新数据库中的 URL
```

AI 会生成脚本帮您批量上传。

---

## 第四步：验证迁移结果

### 4.1 检查题目数量

在新项目首页，确认题目数量与原项目一致。

### 4.2 随机检查题目

打开几道题目，确认：
- ✅ 题目图片正常显示
- ✅ 答案图片正常显示
- ✅ 已知条件正确
- ✅ 解题步骤完整
- ✅ 苏格拉底模式正常工作

### 4.3 测试功能

- ✅ 点击已知条件查看提示
- ✅ 点击解题步骤查看提示
- ✅ 启动苏格拉底模式并回答问题
- ✅ 查看学习进度页面

---

## 常见问题

### Q1: 图片 URL 失效怎么办？

A: 图片 URL 是 S3 的公开链接，理论上不会失效。如果失效，说明原账号的 S3 存储被清空。建议在迁移前先下载所有图片。

### Q2: 数据库导入失败怎么办？

A: 可能是字符编码问题。尝试：
1. 用文本编辑器打开 SQL 文件，确保是 UTF-8 编码
2. 手动执行 SQL 语句，逐条排查错误

### Q3: 用户学习记录会迁移吗？

A: 本指南只迁移题目数据。如果需要迁移用户学习记录，需要额外导出 `userProgress` 表。

### Q4: 迁移后原项目还能用吗？

A: 可以。两个项目是完全独立的，互不影响。

---

## 📞 需要帮助？

如果迁移过程中遇到问题，在新对话中说：

```
我在迁移 math-ai-tutor 项目时遇到问题：[描述问题]
```

AI 会帮您解决。

---

## 🎉 迁移完成！

恭喜！您已成功将 Math AI Tutor 项目迁移到新账号。现在可以继续开发和添加新功能了。

**下一步建议：**
1. 添加题目分类和筛选功能
2. 实现答案图片显示功能
3. 添加错题本功能
